FORMAT: 1A
HOST: http://localhost:8080/

# TrueBlocks API Blueprint

The TrueBlocks API is designed to expose data generated from `trueblocks-core` along with a local Ethereum node. Among other things, it facilitates account history queries.

## Export Transaction Records for Address [/export{?maxBlocks}{?address_list}{?fmt}{?articulate}{?logs}]

A resource that tells trueblocks that you want to export transactions for `address`. Trueblocks will use its appearance index to ask the node for detailed information about each appearance. The information is then returned in either JSON or CSV.

+ Parameters

    + maxBlocks:  (optional, <val>) - scan at most --maxBlocks blocks ('all' implies scan to end of chain)
    + address_list:  (required, boolean) - one or more addresses (0x...) to export
    + fmt:  (optional, <fmt>) - export format (one of [json|txt|csv])
    + articulate:  (optional, boolean) - articulate transactions, traces, logs, and outputs
    + logs:  (optional, boolean) - export logs instead of transactions

### Export all records for an address [GET]

+ Request Plain Text Export

    + Headers
    
            Accept: text/plain
            
+ Response 200 (text/plain)
    
    + Body
    
            Hash,BlockNumber,TransactionIndex,Timestamp,Date,From,FromName,To,ToName,EtherValue,DollarsThen,EtherGasCost,GasCostThen,GasUsed,isError,inFlow,outFlow,Internal,Encoding,FunctionName,Category,Note
            "0xced11523d71c444ce6d4296aaf4be2198d13358dd33925218ba5e49ccee5de43","7218566","6","1550131308","2/14/2019 8:01:48","0x512e07a093aaa20ba288392eadf03838c7a4e522",,"0x0",,"0","0","0.113701400000000000","13.871571937014","5685070","0","","","0","0x60806040",,"contract creation",

+ Request JSON Export

    + Headers
    
            Accept: application/json
            
+ Response 200 (application/json)

    + Body
    
            {status: "ok",
            data: [
                {
                  "hash": "0x184ff1f00c1c5da9c62774e4e2bf0925de39046e056c13edf31f0bb9ce4d9b38",
                  "blockHash": "0xda4c0d8c4df359aeb0dbcdc98767da4f31f95c3a9eb705a96933bd5322c8007f",
                  "blockNumber": 89796,
                  "transactionIndex": 6,
                  "timestamp": 1439629343,
                  "from": "0xe6a7a1d47ff21b6321162aea7c6cb457d5476bca",
                  "to": "[0;36m0x3b01ebd2419f6d39db6ab4471e6382848716641f[0m",
                  "value": 83372067757175030000,
                  "gas": 22000,
                  "gasPrice": 55815739021,
                  "isError": 0,
                  "receipt": {
                    "contractAddress": "0x0",
                    "gasUsed": 21000,
                    "logs": [],
                    "status": null
                  },
                  "traces": [],
                  "gasCost": 1172130519441000,
                  "gasUsed": 21000,
                  "date": "2015-08-15 09:02:23 UTC",
                  "datesh": "2015-08-15",
                  "time": "9:02:23 UTC",
                  "age": "21450442",
                  "ether": 83.372067757175030000
                }
            ]}

## List appearance locations for an address [/list{?maxBlocks}{?filenames}{?check}{?data}{?sort}{?fix}{?list}{?cacheBals}{?balances}{?import}{?remove}{?truncate}{?maxBlock}{?merge}{?fmt}]

A resource that tells trueBlocks that you want to list appearances for `address`. Trueblocks returns its appearance index, each appearance consisting of `{blockNumber, txId}`. 

+ Parameters

    + maxBlocks:  (optional, <val>) - scan at most --maxBlocks blocks ('all' implies scan to end of chain)
    + filenames:  (required, boolean) - path(s) of files to check, merge, fix or display (default=display)
    + check:  (optional, boolean) - check for duplicates and other problems in the cache
    + data:  (optional, boolean) - in 'list' mode, render results as data (i.e export mode)
    + sort:  (optional, boolean) - sort the list of transactions and re-write (precludes other modes, other than --dedup)
    + fix:  (optional, boolean) - remove duplicates from the cache (if any)
    + list:  (optional, boolean) - list the contents of the cache (the default if no other option)
    + cacheBals:  (optional, boolean) - cache per block account balances for each account
    + balances:  (optional, boolean) - export account balances for each account
    + import:  (optional, boolean) - import transactions if import.txt file exists in current folder
    + remove:  (optional, boolean) - remove transactions if remove.txt file exists in current folder
    + truncate:  (optional, <num>) - truncate the cache at block :n (keeps block 'n' and before, implies --fix)
    + maxBlock:  (optional, <num>) - for testing, max block to visit
    + merge:  (optional, boolean) - merge two or more caches into a single cache
    + fmt:  (optional, <fmt>) - export format (one of [json|txt|csv])

### List all appearances for an address [GET]

+ Request Plain Text Export

    + Headers
    
            Accept: text/plain
            
+ Response 200 (text/plain)
    
    + Body
    
            89796   6
            89880   3
            94675   17
            94754   3
            99979   10
            101279  0
            105338  18
            105439  2
            110350  40
            110457  1
            112698  35
            112789  0

## View account detail [/accounts{?terms}{?expand}{?matchCase}{?owned}{?custom}{?prefund}{?named}{?addr}]

I don't really know what this is.

+ Parameters

    + terms:  (required, boolean) - a space separated list of one or more search terms
    + expand:  (optional, boolean) - expand search to include all fields (default searches name, address, and symbol only)
    + matchCase:  (optional, boolean) - do case-sensitive search
    + owned:  (optional, boolean) - Include personal accounts in the search
    + custom:  (optional, boolean) - Include your custom named accounts
    + prefund:  (optional, boolean) - Include prefund accounts
    + named:  (optional, boolean) - Include well know token and airdrop addresses in the search
    + addr:  (optional, boolean) - display only addresses in the results (useful for scripting)

### Account detail [GET]

+ Request JSON data

    + Headers
            
            Accept: application/json
            
+ Response 200 (application/json)

    + Body
    
             { "type": "CEthState", "data": [
                  {
                    "schema": 5005,
                    "deleted": 0,
                    "showing": 1,
                    "cname": "EthState",
                    "blockNumber": 1365929,
                    "balance": 0,
                    "nonce": 0,
                    "code": "0x",
                    "storage": "",
                    "address": "0x06012c8cf97bead5deae237070f9587f8e7a266d",
                    "deployed": 0,
                    "accttype": "EOA",
                    "ether": 0.000000000000000000
                  }
                ], "meta": {"pending": 622000,"staging": 622000,"finalized": 539800,"client": 1365929 } }

## View block detail [/blocks{?block_list}{?hash_only}{?check}{?addrs}{?uniq}{?uniqTx}{?number}{?filter}]

Look at a block.

+ Parameters

    + block_list:  (required, boolean) - a space-separated list of one or more blocks to retrieve
    + hash_only:  (optional, boolean) - display only transaction hashes, default is to display full transaction detail
    + check:  (optional, boolean) - compare results between qblocks and Ethereum node, report differences, if any
    + addrs:  (optional, boolean) - display all addresses included in the block
    + uniq:  (optional, boolean) - display only uniq addresses found per block
    + uniqTx:  (optional, boolean) - display only uniq addresses found per transaction
    + number:  (optional, boolean) - display address counts (alterntively --addrCnt, --uniqTxCnt, or --uniqCnt)
    + filter:  (optional, <addr>) - useful only for --addrs or --uniq, only display this address in results

### Block detail [GET]

+ Request JSON data
    
    + Headers
    
            Accept: application/json
            
+ Response 200 (application/json)

    + Body
    
            [
                {
                    "gasLimit": 3141592,
                    "gasUsed": 0,
                    "hash": "0x3e5c2f13bc01a0a32c7eda3560ec3ede19c9d2f6c0fda8436999eee2914e862d",
                    "blockNumber": 101010,
                    "parentHash": "0x8290679004240a002dcf274bf56310c2654b5137c643e5c20ff647ebda61033b",
                    "miner": "0xc603ab5ef41fc61aa8b76beddb09e3cfcbb174bd",
                    "difficulty": 3871451743585,
                    "price": 0,
                    "finalized": 1,
                    "timestamp": 1439815989,
                    "transactions": [],
                    "date": "2015-08-17 12:53:09 UTC",
                    "age": "21263796"
                }
            ]